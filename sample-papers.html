<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LAST YEAR SAMPLE PAPER</title>
    <script src="https://js.puter.com/v2/"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 p-6">
    <div class="max-w-3xl mx-auto bg-white p-8 rounded-3xl shadow-xl">
        <h2 class="text-3xl font-bold text-indigo-600 mb-6">Find Past Paper Questions</h2>
        
        <textarea id="student-query" placeholder="Search for a topic (e.g. 'Questions on Exponents from 2021')" 
                  class="w-full p-4 border rounded-xl mb-4 h-32 outline-none focus:ring-2 focus:ring-indigo-400"></textarea>
        
        <button onclick="searchArchive()" class="w-full bg-indigo-600 text-white font-bold py-4 rounded-xl">Search 8-Year Archive</button>
        
        <div id="ai-result" class="mt-6 p-5 rounded-2xl hidden border leading-relaxed"></div>
    </div>

    <script>
        async function searchArchive() {
            const query = document.getElementById('student-query').value;
            const resultBox = document.getElementById('ai-result');
            resultBox.classList.remove('hidden');
            resultBox.innerText = "AI is scanning your cloud archive...";

            try {
                // Fetch the data the Admin uploaded
                const archiveData = await puter.kv.get('exam_archive_8years') || "[]";

                const prompt = `
                    Student Query: "${query}"
                    Available Papers: ${archiveData}
                    
                    Instruction:
                    If a match is found, provide the Year, Subject, and this Link: [downloadURL].
                    If no match, reply exactly: "MISSING: We don't have this paper."
                `;

                const response = await puter.ai.chat(prompt, { model: 'gpt-4o' });
                resultBox.innerHTML = response.text.replace(/\n/g, "<br>");
                resultBox.className = "mt-6 p-5 rounded-2xl border bg-blue-50 text-blue-900 border-blue-200";

            } catch (err) {
                resultBox.innerText = "Error searching database.";
            }
        }
    </script>
</body>
</html>
